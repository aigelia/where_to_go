# Москва глазами Артема: сайт-карта на Django

Небольшой сайт для размещения информации о лучших местах и событиях столицы. Позволяет оставить отметку на карте и добавить название и описание места и события, а также связанные с ними фотографии.

## Функционал

Через админ-панель пользователь может добавлять новые места на карте, указывая для них координаты, названия, краткие и подробные описания, а также иллюстрировать места и события фотографиями.

Редактирование подробного описания осуществляется с помощью визуального редактора; порядок фотографий можно менять прямо в админке.

Также доступна management-команда для автоматической загрузки данных о локациях из json-файлов:

```shell
python manage.py load_place https://example.com
```

По указанной ссылке должен находиться json-файл такого формата:

```
{
    "title": "Воробьёвы горы",
    "imgs": [
        "https://raw.githubusercontent.com/devmanorg/where-to-go-places/master/media/79403aa7fa5d1d2e06eabe8827e8c96e.jpg",
        "https://raw.githubusercontent.com/devmanorg/where-to-go-places/master/media/8c76689889c54f132d6b084367e936ca.jpg"
    ],
    "description_short": "Место, где бывал Шаляпин, где смотрел на зеркальную фабрику Пётр I, где начинался первый водопровод, где находится главный университет России. Место, которое существует уже 150 000 000 лет.",
    "description_long": "<p>Воробьёвы горы — это <strong>главная смотровая площадка Москвы.</strong> Фактически это не горы, а берег реки, изрезанный обрывами и оползнями. Здесь из-под земли пробиваются ключи и родники. Этому месту 150 000 000 лет. Раньше здесь было море, а потом — одно из древнейших поселений человека.</p><p>О селе, находившемся здесь, известно не очень много. В 1435 году его купила одна боевая княгиня, которая и княжеством управляла, и с удельными князьями боролась, и Москву от татар обороняла. Купила она его у попа по имени Воробей — отсюда и пошло название. Иногда, правда, говорят, что имя своё горы получили оттого, что в этой местности исторически жило много воробьёв.</p><p>Что помнят Воробьёвы горы? Пожар 1547 года, крымских ханов, гетмана Хаткевича, бежавшего сюда в смутное время. Оборону против Наполеона в 1812 году. Помнят они и увеселительные традиции Петра I, и стрельбу из пушек, и первую в России зеркальную фабрику. Песок с Воробьёвых гор издавна славился своим качеством и долгое время использовался вместо промокательной бумаги. Помнят горы и заключение мира с Турцией, и расположенную здесь в XIX столетии пересыльную тюрьму.</p><p>С 1 сентября 1900 года здесь стали возводить Рублёвский водопровод. Город рос, воды не хватало, и тогда из Москвы-реки именно через воробьёвские резервуары пошло водоснабжение города.</p><p>Это натолкнуло на идею строительства парка. Идея витала в воздухе, но дальше смутных мечтаний ничего не пошло. Москвичи приезжали сюда погулять — выпить чаю, цыган послушать. В 1924 году здесь были крестьянские сады с врытыми в землю столами и лавками, с рукописными вывесками «Волна», «Свидание друзей», «Эльдорадо», ждавшие своих гостей.</p><p>С 1953 года начинается эра МГУ, появляется площадка с великолепной панорамой Москвы и лыжным трамплином. Здесь же строят станцию метро, но крайне неудачно: чтобы не сорвать сроки, строители добавляют в бетон соль, что приводит к скорому разрушению конструкции. Спустя какое-то время станция на долгое время становится слепой точкой на карте Московского метрополитена, оставив в назидание торопыгам заброшенный эскалаторный свод.</p><p>В ресторане, располагавшемся на смотровой площадке, часто пел Шаляпин. Зимой здесь катались на лыжах и санках, а летом можно было покататься на моторной лодке или пароходике.</p><p>Советское правительство задумало построить здесь целый город — стадион на 40 000 мест, парк, открытый театр. К последнему собирались подвести все виды транспорта, в том числе и самолёт. Но почему-то воплощать эту идею не стали.</p><p>Что такое <strong>Воробьёвы горы</strong> сейчас? Природный заказник с раздельным сбором мусора, отличными информационными табличками, семьёй соколов, которые живут здесь, и с уютными местами для пикника.</p><p>А ещё сюда приглашали французскую художницу, чтобы она запечатлела виды гор. Она долго вглядывалась в панораму города с холма. А потом опустила кисточку со словами: «Не смею…».</p><p>Если вы подумываете о том, чтобы начать новую жизнь, приходите сюда на закате и мечтайте. Может быть, это магическое место вам что-нибудь да подскажет.</p>",
    "coordinates": {
        "lng": "37.60177113595118",
        "lat": "55.72962366151958"
    }
}
```

Если в базе данных есть локация с аналогичным названием, загрузка буде остановлена, а место не добавлено на карту.

## Установка и запуск

Необходимо клонировать этот репозиторий, создать и активировать виртуальное окружение Python свежей версии, а затем установить зависимости:

```shell
git clone https://github.com/aigelia/where_to_go.git
cd where_to_go

python3 -m venv .venv
source .venv/bin/activate

pip install -r requirements.txt
```

Затем создайте в корне проекта файл .env и определите в нем минимальный набор переменных окружения:

- `SECRET_KEY` — ключ Django для защиты сессий, CSRF и другой криптографии. Можно сгенерировать любую случайную строку.  
- `DEBUG` — режим отладки; для локального запуска оставьте `True`.  
- `ALLOWED_HOSTS` — список разрешённых хостов, для локальной разработки обычно `127.0.0.1,localhost`.

После этого выполните миграции, чтобы создать базу данных SQLite:

```shell
python manage.py migrate
```

Наконец, для использования админки в локальной разработке создайте суперпользователя, выбрав для него электронную почту, логин и пароль:
```shell
python manage.py createsuperuser
```
Готово, можно запускать локальный сервер:
```shell
python manage.py runserver
```
Сайт будет доступен по адресу http://127.0.0.1:8000/, а админ-панель - по адресу http://127.0.0.1:8000/admin/ (для входа потребуется ввести логин и пароль, указанные при создании суперпользователя).

## Цели проекта ##

Код написан в учебных целях — для курса по Python и веб-разработке на сайте [Devman](https://dvmn.org).